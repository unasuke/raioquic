require "raioquic"

# quiche
curl_example_1 = [
  "c400000001101b631c6391a91309c29395aaa5c180bc14db7dafc0e1c10407ff4a9527a71103bb7eb59a91004120487b50905ab8b9b40a27ca5bcbf7" \
  "72f2d4fc76d64f4b81e9c713e872df9d9dba3f65cf1ed5673b0b3da9ca484779da091e11c0627c0c1f46f211bb02ca838a44644594073abaa7001523" \
  "94d9d27b8c996294be08843066e2a20724f9f565d18235af6d6a70cae0021118a36248abe019b261be18b41b55aeb5efa99d82d78c4cdf914447b86b" \
  "dfa8c2e71869dd11ba0f07ef3a706e4210906ab7185331c8170e2e4221b1c5a8a7344dbb314d3431b16ec0097d6735cbf1aca08230b03df55f65ce90" \
  "8f641c010d3d049c9bc1c54f7b5aca0715abba7dad2b44270e79b5f3a867da03e45ddf3c4193e513ed6c0d2006452b8a149cf6dc4f506312ad5bb664" \
  "c51ed3339225a574b769ca32a4b927b00d3f6e8b672ebbf8255c08b9077ffa8cede10000000000000000000000000000000000000000000000000000" \
  "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" \
  "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" \
  "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" \
  "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" \
  "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" \
  "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" \
  "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" \
  "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" \
  "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" \
  "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" \
  "00000000000000000000000000000000000000000000000000000000000000000000000000000000"
].pack("H*")

# ngtcp2 (truncated? fail)
curl_example_2 = [
  "cc00000001147853c13a63feb90590ad1f99fde50ba3a0b4e273146dac002025588fac2f6babc042d54f4fdf6cd8b2008000047c88e4cfda0a59ed18" \
  "9f5540e4f1fd276631aea6e1b8ea13e8d5018362dcbef4104479f379fe24f87d1822b7742791c8cbca1ae9812c5cadf319b5c06bafcb825a0651d95c" \
  "4fe7e3e76ded189ad7b7910998401def64b085aaa29254608b0c8a510a834849d59430a849b5287ad2074e744adf629e868e5722f906e1816a7d0c37" \
  "35faa84d5fbe5553e887b83e35f0ee56de69f223d98def0cbf41a4b1f38d811ed707cb97262644444a96d7701dc664f4214a2d805e9fe5a0f5372fdd" \
  "d70537cb00fd7f4d7b7e1980e14e5dd360679cb64ff0cad1223e085ac40c549046d0b09a322d4ad41c6dcd51213933b374f691cde758e600c16ae4a1" \
  "3a1bfd8f2c60010dfc899925ee7346b048b58c9036f129b88a4db232a3fa7c8d59d8e0dbbf1819d1f76604dcbc2cbc4d3313c447708a9a1ae2845e91" \
  "0baa80cf27cf67dc24be9f15176f6f7aadaf0f42ba1fb04d9200d63325699c4de42c917877cb90a925cbf169b0ec8762b88268f75d37e596c17ac6d7" \
  "c21c72f981c2ad5e1f3818c369221616c2d0e32b060b0924aaf36693b4da18dab677aa8148eee82262e121efb174c469b62d69c63157b1cc5135a4ec" \
  "055acd36878c4d3c71594e35ea9d1a775ace45555cf0ee2a61fc0565751560a770ecdf094122c93026b670cfeee263aec8ca4c3f033ba888fe74e500" \
  "f63450dc2472f06beed7919191e5bc009875013b262ab07fcf4704c1084df2bcb58c9f9a7928e0129111e4cf4ef746943013ddd129da3394c10b459d" \
  "96db2f94fb41a2191453d9cf16b62402a9c9c765c60fc914a24b6b5712bef5714ddff974d12b32e083a9cf4d0602142ee8b1b0be5c2b36ad69891034" \
  "74e38e27cac3b2bd2c8f7af45fe9fd106fd071f432015b7fe7135932c49f34824c78b9654c0bc236011884be16eb0c2880fda8e2e32b962e0b31a218" \
  "28e20097443e46d22066bf10105bb24676059208ec3c95887d7820786bb6675d7bc74faa9f4166b1acd2112328726ebed52d9eb8a60069fe143f3b08" \
  "5f574ca460c2754597c405dafcdc536fff8a3fe350d159d3f9526385e5999588d41bd6cc6b9898147b1b396c574c3de3f33ea8738b882284f1a794af" \
  "ff85571041f49c5798badda91e691305189f98d17bc995bf1acdc11762a3e5ce00ba72c73b04fdd5a77a19fd6b81f29999a1825cbffe721ccfb86a31" \
  "2c6921551f8514d10a0df82364050973f0b3d875e2e108e70d6c177c2d12f57b4006e891a7355a0dd57992233db5b1e80598dffd88d974636728a60e" \
  "d2b1753ab9b44e48f22a4a7132be414778bfe7ff10f036d1ae3572d31199c42197f8e968044af68a"
].pack("H*")

# msh3 (truncated? fail)
curl_example_3 = [
  "cf000000010805247d899c856735000044b206788565ce951f66d6129e1e9b09fb9fff8b31f40d15e74440a58a041dc8c1410159fa9a6f6b0eb0a499" \
  "554cee7ce3c23fa66ebbff0de3a38fd84466e423e06809aca0ceaf2fb289f9f481bbe31df3614ce9bf444e25f17482180dbdeef8d423a80a1a2989fe" \
  "3911b5c0273fc254f9e5a67065e20f4e7c3d3884e475f2605a3ba5dc4c92091232b1e5930fe3b1f6099ac519e3704925c071a2d4100ad042cf64fe64" \
  "907123e27c42da9214fa91e7a897f876de98a997f4c6c14a528a817577faa240ecd30055d68d57b554b4ba1a1c28cbecd99d731a8d3adca8d43c93c8" \
  "723ee2205daab557760c6795563b8d68482c40dbb6016eb9583e4cba4164e906816872f0481be1acc89d4683635e3757ad2ae179cf85efd76f518368" \
  "191aa547fd9a7447621f1340a93b275652c196a219b2e5f57aec8aa9ddd0d3d5c81a46eb4f8c1d95a01fe68c1a8becc79b515bf06f9ba065a99e6af1" \
  "b5719be2821d696507504734e9f0377f73f7f868396f2347f2ebcca153e1f7c5541c171f0ead8049348d8627e6a78a7a11922c1fe97a677683efccff" \
  "514da5a4ff425a2b986a1b5cd4010aa677905bc30c0997bbbeccf1c8c18170060740848546fbf90668691086c4abbc64b47c1f91bdb2f11f0f05002b" \
  "bc429b9c5f745714e317b5fd5ac3b6f64dcc7e1ad8dba88db0f065bc0fb2938b755cacd2736d419549175f241aef529e8f8cc6a334b96b2d0ee4f716" \
  "58734dcaf2f80924693d7878efebdb67cf5c0a7bb7653f0f7697926a0858d1dd48d2da0473724b5914350fe562203fe41a96b25c7c07d315fe6ce245" \
  "936da6a3222d67cd1af56c0fe1043d4c9647dd4068f4d77da5e9414f46a017cc3347e776e71fd8781b21ffbbfe9300a705145f3330fa2fc4c197c960" \
  "ce8ecf93e3c02cbce557b56519d39af21f79d50df94b905a49a35ed795cd017ebcfedcbbcb008bbf27b6a6f795927bf498b1d617fdaeda0b7a0ea1a9" \
  "7f268fed0071d1b1eafad954a1cb8ed04bac1fe5568814be6db1004faa43d876e91fb091c77c6acdee00606e3b12b96ebb11d57a1a5a880657cd0e50" \
  "7f00188dd30191d9e49582ff47f63e8c877044ff4ac7c207f213768f755966c94529afc7d6ac56ce6457aaa0093b1fa268197d3060012967cf026aaa" \
  "ffa83f629f9cdbb980a4cb6a324f20ada736f51aa73a10b869f2a374823733e336e1fdb4482081a5157c5410a765e6f7959b9f8bb002d6599b3c1a99" \
  "235f807e6159b846df2132d820a7409f1006c1dd5980ab10c4ae174341ac7c9153305adda721e0a756e80c699e1703dda63349d55cbc338bd5c7b0a0" \
  "492b9676913d7015a20a883d8448eead14730e1c5cf2653e8bcc3bed110f9d52deecf27739e73fd3"
].pack("H*")


[curl_example_1, curl_example_2, curl_example_3].each do |curl_example|
  buf = Raioquic::Buffer.new(data: curl_example)
  pp Raioquic::Quic::Packet.pull_quic_header(buf: buf, host_cid_length: 8)
  puts "\n"
end
